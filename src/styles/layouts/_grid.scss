// Section: Layout
// Module: Grid | Grid Inline

@use 'sass:math';
@use '../utilities/functions' as FN;
@use '../utilities/variables' as VAR;

/**
 * @description Establishes a grid container.
 */
@mixin grid {display: grid;}

/**
 * @description Establishes a inline-grid container.
 */
@mixin grid-inline {display: inline-grid;}

// Grid Template Mixins
@mixin cols($count) {grid-template-columns: repeat($count, minmax(0, 1fr));}
@mixin rows($count) {grid-template-rows: repeat($count, minmax(0, 1fr));}


/**
* @description Establishes a grid container with a specified number of columns.
* @param {number} $count - The number of columns.

/// EXAMPLE USAGE
.custom-grid {
  display: grid;
  @include cols-custom("1fr_auto_1fr");
}

*/

@mixin cols-custom($template) {
  // Convert underscores to spaces so "1fr_auto" becomes "1fr auto"
  $converted: FN.str-replace($template, "_", " ");

  grid-template-columns: $converted;
}

// Auto-fit/fill Mixins
@mixin auto-fit($min-width) {grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));}
@mixin auto-fill($min-width) {grid-template-columns: repeat(auto-fill, minmax($min-width, 1fr));}

// Grid Flow Mixins
@mixin flow-in-row { grid-auto-flow: row; }
@mixin flow-in-col { grid-auto-flow: column; }
@mixin flow-dense-items { grid-auto-flow: dense; }

// Grid Alignment Mixins

/**
 * @description justify-items container.
 * @param {string} $value - The value for the justify-items property.
 */
@mixin justify-items($value) {justify-items: $value;}

/**
 * @description Establishes a align-items container.
 * @param {string} $value - The value for the align-items property.
 */
@mixin align-items($value) {align-items: $value;}

/**
 * @description Establishes a place-items container.
 * @param {string} $value - The value for the place-items property.
 */
@mixin place-items($value) {place-items: $value;}

// Grid Item Placement Mixins
@mixin span-col($span) {grid-column: span $span / span $span;}
@mixin span-row($span) {grid-row: span $span / span $span;}
@mixin col-start($start) {grid-column-start: $start;}
@mixin col-end($end) {grid-column-end: $end;}
@mixin row-start($start) {grid-row-start: $start;}
@mixin row-end($end) {grid-row-end: $end;}

@mixin grid-position($col, $row) {
  grid-column: $col;
  grid-row: $row;
}
@mixin position-col($col) {
  grid-column: $col;
}
@mixin position-row($row) {
  grid-row: $row;
}

@mixin grid-gap($value) { gap: $value; }
@mixin col-gap($value) { column-gap: $value; }
@mixin row-gap($value) { row-gap: $value; }

// Classes
.grid { @include grid; }
.grid.inline { @include grid-inline; }


@for $i from 1 through VAR.$column-count {
  .grid.cols-#{$i} { @include cols($i); }
  .grid.rows-#{$i} { @include rows($i); }
}

// Grid Template Classes
@each $breakpoint, $width in VAR.$breakpoints {
  // Responsive grid columns
  @media (min-width: #{$width}) {
    @for $i from 1 through VAR.$column-count {
      .grid.cols-#{$i}\@#{$breakpoint} { @include cols($i); }
      .grid.rows-#{$i}\@#{$breakpoint} { @include rows($i); }
    }
  }
}


// Add corresponding classes
.grid-gap-1 { @include grid-gap(0.25rem); }
.grid-gap-2 { @include grid-gap(0.5rem); }
.grid-gap-4 { @include grid-gap(1rem); }
.col-gap-1 { @include col-gap(0.25rem); }
.col-gap-2 { @include col-gap(0.5rem); }
.col-gap-4 { @include col-gap(1rem); }
.row-gap-1 { @include row-gap(0.25rem); }
.row-gap-2 { @include row-gap(0.5rem); }
.row-gap-4 { @include row-gap(1rem); }

// Responsive grid gaps
@each $breakpoint, $width in VAR.$breakpoints {
  @media (min-width: #{$width}) {
    .grid-gap-1\@#{$breakpoint} { @include grid-gap(0.25rem); }
    .grid-gap-2\@#{$breakpoint} { @include grid-gap(0.5rem); }
    .grid-gap-4\@#{$breakpoint} { @include grid-gap(1rem); }

    .col-gap-1\@#{$breakpoint} { @include col-gap(0.25rem); }
    .col-gap-2\@#{$breakpoint} { @include col-gap(0.5rem); }
    .col-gap-4\@#{$breakpoint} { @include col-gap(1rem); }
    
    .row-gap-1\@#{$breakpoint} { @include row-gap(0.25rem); }
    .row-gap-2\@#{$breakpoint} { @include row-gap(0.5rem); }
    .row-gap-4\@#{$breakpoint} { @include row-gap(1rem); }
  }
}


// Generate Column Span Classes with Responsive Variants
@for $i from 1 through VAR.$column-count {
  .span-col-#{$i} {
    @include span-col($i);
  }

  .span-row-#{$i} {
    @include span-row($i);
  }

  @each $breakpoint, $width in VAR.$breakpoints {
    @media (min-width: #{$width}) {
      .span-col-#{$i}\@#{$breakpoint} {
        @include span-col($i);
      }

      .span-row-#{$i}\@#{$breakpoint} {
        @include span-row($i);
      }
    }
  }
}


// Auto-fit/fill Classes
@each $size, $width in VAR.$grid-item-sizes {
  .grid.auto-fit-#{$size} { @include auto-fit($width); }
  .grid.auto-fill-#{$size} { @include auto-fill($width); }
}

// Flow Classes
.grid.flow-row { @include flow-in-row; }
.grid.flow-col { @include flow-in-col; }
.grid.flow-dense { @include flow-dense-items; }

// Alignment Classes
$alignments: (
  'start': start,
  'end': end,
  'center': center,
  'stretch': stretch
);

@each $name, $value in $alignments {
  .justify-items-#{$name} { justify-items: $value; }
  .align-items-#{$name} { align-items: $value; }
  .place-items-#{$name} { place-items: $value; }

  @each $breakpoint, $width in VAR.$breakpoints {
    @media (min-width: #{$width}) {
      .justify-items-#{$name}\@#{$breakpoint} {
        justify-items: $value;
      }
      .align-items-#{$name}\@#{$breakpoint} {
        align-items: $value;
      }
      .place-items-#{$name}\@#{$breakpoint} {  
        place-items: $value;
      }
    }
  }
}
