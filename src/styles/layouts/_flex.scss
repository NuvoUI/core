@use 'sass:math';
@use '../utilities/variables' as *;

// Flex Container Mixins
@mixin flex {display: flex;}
@mixin flex-inline {display: inline-flex;}

// Direction Mixins
@mixin row {flex-direction: row;}
@mixin row-reverse {flex-direction: row-reverse;}
@mixin col {flex-direction: column;}
@mixin col-reverse {flex-direction: column-reverse;}

// Wrap Mixins
@mixin wrap {flex-wrap: wrap;}
@mixin nowrap {flex-wrap: nowrap;}
@mixin wrap-reverse {flex-wrap: wrap-reverse;}

// Main Axis Alignment Mixins
@mixin start {justify-content: flex-start;}
@mixin end {justify-content: flex-end;}
@mixin center {justify-content: center;}
@mixin between {justify-content: space-between;}
@mixin around {justify-content: space-around;}
@mixin evenly {justify-content: space-evenly;}

// Cross Axis Alignment Mixins
@mixin align-start {align-items: flex-start;}
@mixin align-end {align-items: flex-end;}
@mixin align-center {align-items: center;}
@mixin align-stretch {align-items: stretch;}
@mixin align-baseline {align-items: baseline;}

// Self Alignment Mixins
@mixin self-auto {align-self: auto;}
@mixin self-start {align-self: flex-start;}
@mixin self-end {align-self: flex-end;}
@mixin self-center {align-self: center;}
@mixin self-stretch {align-self: stretch;}

// Flex Child Mixins
@mixin w-full {flex: 0 0 100%;}
@mixin w-auto {flex: 1 1 auto;}
@mixin grow { flex: 1 1 0%; }
@mixin no-grow { flex: none; }

@mixin w-col($size) {
  flex: 0 0 math.percentage(math.div($size, $column-count));
}

// Base flex container
.flex {
  display: flex;
  
  // Direction modifiers
  &.row { flex-direction: row; }
  &.row-reverse { flex-direction: row-reverse; }
  &.col { flex-direction: column; }
  &.col-reverse { flex-direction: column-reverse; }
  
  // Wrap modifiers
  &.wrap { flex-wrap: wrap; }
  &.nowrap { flex-wrap: nowrap; }
  &.wrap-reverse { flex-wrap: wrap-reverse; }
  
  // Justify modifiers
  &.start { justify-content: flex-start; }
  &.end { justify-content: flex-end; }
  &.center { justify-content: center; }
  &.between { justify-content: space-between; }
  &.around { justify-content: space-around; }
  &.evenly { justify-content: space-evenly; }
  
  // Align modifiers
  &.items-start { align-items: flex-start; }
  &.items-end { align-items: flex-end; }
  &.items-center { align-items: center; }
  &.items-baseline { align-items: baseline; }
  &.items-stretch { align-items: stretch; }
  
  // Child flex items (using column count)
  > .w-auto { @include w-auto }
  > .w-full { @include w-full }
  > .grow { @include grow; }
  > .no-grow { @include no-grow; }
  @for $i from 1 through $column-count {
    > .w-#{$i} { @include w-col($i) }
  }
}


// Responsive variants
@each $breakpoint, $width in $breakpoints {
  @media (min-width: $width) {
    .flex {
      // Direction
      &.row\@#{$breakpoint} { flex-direction: row; }
      &.row-reverse\@#{$breakpoint} { flex-direction: row-reverse; }
      &.col\@#{$breakpoint} { flex-direction: column; }
      &.col-reverse\@#{$breakpoint} { flex-direction: column-reverse; }
      
      // Wrap
      &.wrap\@#{$breakpoint} { flex-wrap: wrap; }
      &.nowrap\@#{$breakpoint} { flex-wrap: nowrap; }
      &.wrap-reverse\@#{$breakpoint} { flex-wrap: wrap-reverse; }
      
      // Justify
      &.start\@#{$breakpoint} { justify-content: flex-start; }
      &.end\@#{$breakpoint} { justify-content: flex-end; }
      &.center\@#{$breakpoint} { justify-content: center; }
      &.between\@#{$breakpoint} { justify-content: space-between; }
      &.around\@#{$breakpoint} { justify-content: space-around; }
      &.evenly\@#{$breakpoint} { justify-content: space-evenly; }

      // Align
      &.items-start\@#{$breakpoint} { align-items: flex-start; }
      &.items-end\@#{$breakpoint} { align-items: flex-end; }
      &.items-center\@#{$breakpoint} { align-items: center; }
      &.items-baseline\@#{$breakpoint} { align-items: baseline; }
      &.items-stretch\@#{$breakpoint} { align-items: stretch; }

      // Width (using column count)
      & > .w-auto\@#{$breakpoint} { flex: 1 1 auto; }
      & > .w-full\@#{$breakpoint} { flex: 0 0 100%; }
      & > .grow\@#{$breakpoint} { @include grow; }
      & > .no-grow\@#{$breakpoint} { @include no-grow; }
      @for $i from 1 through $column-count {
        & > .w-#{$i}\@#{$breakpoint} { @include w-col($i) }
      }
    }
  }
}